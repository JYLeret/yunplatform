if(typeof infosoftglobal=="undefined"||typeof infosoftglobal.FusionCharts=="undefined"){alert("FusionChartsExport: object::FusionCharts was not found. Verify script inclusions.",10901271400);throw"FusionChartsExportComponentFatalError::10901271400"}infosoftglobal.FusionChartsExportObject=function(){_FCEO.initializeComponent(this,arguments)};var FusionChartsExportObject=infosoftglobal.FusionChartsExportObject;var _FCEO=infosoftglobal.FusionChartsExportObject;_FCEO.defaultParameters={id:undefined,swfLocation:undefined,componentAttributes:{width:"120",height:"40",bgColor:"",modalExport:"0",strictTrigger:"0"},exportAttributes:{},sourceCharts:[],debugMode:false,outerHTML:""};_FCEO.checkFlashVersion=false;var FC_ExportComponentReady=function(a){_FCEO.flushRack(a);return true};var FC_ExportDataReady=function(a){return _FCEO.relayStream(a)};_FCEO.prototype.Render=function(a){return this.render(a)};_FCEO.prototype.BeginExport=function(){return _FCEO.batchExport(this,this.sourceCharts)};_FCEO.prototype.BeginExportAll=function(){return _FCEO.batchExport(this,_FCEO.probeCharts())};_FCEO.prototype.GetOuterHTML=function(){this.update();return this.outerHTML};_FCEO.prototype.render=function(a){var d=_FCEO.L.get(a);if(!d||!_FCEO.L.isObj(d.innerHTML,"string")){this.trace(_FCEO.R.errContainer,10902091233);return false}this.update();try{this.srcObj.render(d)}catch(b){this.trace(_FCEO.R.errFusion+"\n"+b,10902101448)}return true};_FCEO.prototype.update=function(){_FCEO.updateComponent(this)};_FCEO.prototype.trace=function(b,a){_FCEO.trace(b,a,this.debugMode)};_FCEO.prototype.toString=function(){return"[object "+_FCEO.R.resSig+" #"+this.id+" ]"};_FCEO.streamRack={};_FCEO.flags={c:0};_FCEO.playerVersion={major:0,minor:0,rev:0};try{_FCEO.playerVersion=infosoftglobal.FusionChartsUtil.getPlayerVersion()}catch(err){_FCEO.trace("FusionChartsExport: object::Flash Player DetectionError.\n"+err,10902182119)}_FCEO.relayStream=function(b){var a=_FCEO.probeHandler(b);if(a==null){_FCEO.trace(_FCEO.R.errStream,10902041759)}if(!_FCEO.L.isObj(b.parameters.exportParameters)){b.parameters.exportParameters={}}if(!_FCEO.L.isObj(b.parameters.exportParameters.triggerOrdinal,"number")){b.parameters.exportParameters.triggerOrdinal=_FCEO.flags.c++}setTimeout(function(){try{FC_ExportReady(b.meta.DOMId)}catch(d){}},0);if(_FCEO.probeComponent(a)){_FCEO.pushStream(a,[b]);return true}if(!_FCEO.streamRack[a]){_FCEO.streamRack[a]=[]}_FCEO.streamRack[a].push(b);return true};_FCEO.flushRack=function(a){a=_FCEO.probeHandler(a);if(a==null){_FCEO.trace(_FCEO.R.errComponent,10902041939)}if(!_FCEO.probeComponent(a)){_FCEO.trace(_FCEO.R.errComponent,10902041917)}if(!_FCEO.streamRack[a]){return}_FCEO.pushStream(a,_FCEO.streamRack[a]);_FCEO.streamRack[a]=[]};_FCEO.pushStream=function(a,b){return _FCEO.L.get(a).pushData(b)};_FCEO.probeComponent=function(a){if(!a){return false}var b=_FCEO.L.get(a);return b?b.isReady!=null&&b.isReady()==true:false};_FCEO.probeHandler=function(a){if(!a){return null}return _FCEO.L.isString(a)?a:(a.parameters!=null&&_FCEO.L.isString(a.parameters.exportHandler))?a.parameters.exportHandler:null};_FCEO.probeCharts=function(){var a,e,d=[];e=_FCEO.L.tags("object");for(var b=0;b<e.length;b++){a=e[b];if(_FCEO.probeChart(a)){d.push(a)}}e=_FCEO.L.tags("embed");for(b=0;b<e.length;b++){a=e[b];if(a.parentNode!=undefined&&a.parentNode.tagName=="object"){continue}if(_FCEO.probeChart(a)){d.push(a)}}return d};_FCEO.probeChart=function(a){if(a.signature==undefined){return false}var b=a.signature();return(_FCEO.L.isString(b)&&b.indexOf(_FCEO.R.resChartSig)==0)};_FCEO.initializeComponent=function(e,b){if(!b||!b.length||b.length<1){_FCEO.trace(_FCEO.R.errArgs,10902061902)}var a=!_FCEO.L.isString(b[0])&&b.length==1;if(!a&&b.length<2){_FCEO.trace(_FCEO.R.errArgs,10902091732)}var d=0;for(var f in _FCEO.defaultParameters){e[f]=(a?b[0][f]:b[d++])||_FCEO.defaultParameters[f]}if(!_FCEO.L.isString(e.id)||!_FCEO.L.isString(e.swfLocation)){e.trace(_FCEO.R.errArgs,10902091820)}if(_FCEO.playerVersion.major<10){if(_FCEO.checkFlashVersion&&!(e.debugMode||_FCEO.defaultParameters.debugMode)){alert(_FCEO.R.msgNoPlayer)}e.trace(_FCEO.R.errPlayer,10902182131)}e.srcObj=new FusionCharts(e.swfLocation,e.id,0,0,e.debugMode)};_FCEO.updateComponent=function(e){if(!e.srcObj){e.trace(_FCEO.R.errFusion,10902220400)}_FCEO.L.sync(e.componentAttributes,e.srcObj.variables);var a;var b=function(f){return !_FCEO.L.isObj(e.srcObj.variables[f],"undefined")?e.srcObj.variables[f]:_FCEO.defaultParameters.componentAttributes[f]};try{e.srcObj.variables.generator=_FCEO.R.resSig;a=b("width");if(a!=undefined){e.srcObj.setAttribute("width",a);e.srcObj.addVariable("width",a)}a=b("height");if(a!=undefined){e.srcObj.setAttribute("height",a);e.srcObj.addVariable("height",a)}a=b("bgColor");if(a!=undefined){e.srcObj.addParam("bgColor",a)}e.outerHTML=e.srcObj.getSWFHTML()}catch(d){this.trace(_FCEO.R.errFusion+""+d,10902091318)}};_FCEO.batchExport=function(f,g){if(!(g instanceof Array)){f.trace(_FCEO.R.errArgs,10902091853);return[]}var a=[],e=_FCEO.flags.c;_FCEO.flags.c+=g.length;var h=parseInt(f.componentAttributes.strictTrigger||0)==0?function(i){return i}:function(i){i.handlerId=f.id;return i};for(var d=0;d<g.length;d++){var b=_FCEO.L.get(g[d]);if(b==null){f.trace(_FCEO.R.errFusion,10902092026);continue}if(!_FCEO.L.isObj(f.exportAttributes.exportParameters)){f.exportAttributes.exportParameters={}}f.exportAttributes.exportParameters.triggerOrdinal=e++;f.exportAttributes=h(f.exportAttributes);if(b&&b.exportChart){b.exportChart(f.exportAttributes);a.push(b.id)}else{f.trace(_FCEO.R.errFusion+"\nRef: "+b.id,10902092036)}}return a};_FCEO.toString=function(){return"[object "+_FCEO.R.resSig+"]"};_FCEO.trace=function(b,a,d){if(d||_FCEO.defaultParameters.debugMode){_FCEO.L.raise(b,a)}};_FCEO.R={errStream:"Inbound stream missing or stream integrity failure.",errComponent:"Export component missing or authentication failure.",errArgs:"Invalid arguments or parameters out of bounds exception.",errContainer:"Invalid container id or HTMLNode missing from DOM.",errFusion:"Error with internal FusionCharts object. Review parameters.",errPlayer:"Incompatible Flash player or Flash player not installed. Flash Player 10 (or above) is needed for Export Component.",msgNoPlayer:"This page contains elements that require the latest version of Flash Player plugin.",resSig:"FusionChartsExportComponent",resChartSig:"FusionCharts/"};_FCEO.L={isIE:navigator.appName=="Microsoft Internet Explorer",isFF:document.getElementById&&!document.all,tags:function(a,b){if(!_FCEO.L.isString(a)){return[]}return(b||document).getElementsByTagName(a)},get:function(b,a){if(!_FCEO.L.isString(b)){return b}return(a||document).getElementById(b)},getNew:function(b){var e=document.createElement(b),a;for(var d=1;c<arguments.length;d++){a=arguments[d].split("=");e.setAttribute(a[0],a[1])}return e},sync:function(a,d){for(var b in a){d[b]=a[b]}},isString:function(a){return typeof(a)=="string"},isObj:function(b,a){return typeof(b)==(a?a:"object")},raise:function(d,a,b){b=b?("# "+b):"";d="[object "+_FCEO.R.resSig+b+"]\n\nError "+a+".\n"+d+"\n\nRefer to documentation.";alert(d);throw d}};